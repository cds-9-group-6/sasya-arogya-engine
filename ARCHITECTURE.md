# ğŸ—ï¸ Sasya Arogya Engine - Detailed Architecture

## System Overview

The Sasya Arogya Engine is built using a modular, event-driven architecture that supports multiple agricultural services through an intelligent workflow system.

## Core Components

### 1. LangGraph FSM Workflow

```
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚           User Input                â”‚
                                    â”‚                                     â”‚
                                    â”‚ â€¢ Natural language query            â”‚
                                    â”‚ â€¢ Optional plant image              â”‚
                                    â”‚ â€¢ Session context                   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Intent Analysis Layer                                    â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     â”‚    â”‚                     â”‚    â”‚                     â”‚    â”‚
â”‚  â”‚  Agriculture        â”‚    â”‚   Rule Engine       â”‚    â”‚   Context           â”‚    â”‚
â”‚  â”‚  Intent Analyzer    â”‚â—„â”€â”€â–ºâ”‚                     â”‚â—„â”€â”€â–ºâ”‚   Extractor         â”‚    â”‚
â”‚  â”‚                     â”‚    â”‚ â€¢ Insurance rules   â”‚    â”‚                     â”‚    â”‚
â”‚  â”‚ â€¢ Classification    â”‚    â”‚ â€¢ Vendor rules      â”‚    â”‚ â€¢ Plant type        â”‚    â”‚
â”‚  â”‚ â€¢ Treatment         â”‚    â”‚ â€¢ Treatment rules   â”‚    â”‚ â€¢ Location          â”‚    â”‚
â”‚  â”‚ â€¢ Insurance         â”‚    â”‚ â€¢ Priority scoring  â”‚    â”‚ â€¢ Disease context   â”‚    â”‚
â”‚  â”‚ â€¢ Vendor            â”‚    â”‚                     â”‚    â”‚                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Workflow Router                                        â”‚
â”‚                                                                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚             â”‚     â”‚             â”‚     â”‚             â”‚     â”‚             â”‚    â”‚
â”‚     â”‚ Initial     â”‚â”€â”€â”€â”€â–ºâ”‚ Followup    â”‚â—„â”€â”€â”€â”€â”‚ Completed   â”‚     â”‚ Error       â”‚    â”‚
â”‚     â”‚ Node        â”‚     â”‚ Node        â”‚     â”‚ Node        â”‚     â”‚ Node        â”‚    â”‚
â”‚     â”‚             â”‚     â”‚             â”‚     â”‚             â”‚     â”‚             â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚            â”‚                    â”‚                                                   â”‚
â”‚            â–¼                    â–¼                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚                    Service Execution Layer                              â”‚   â”‚
â”‚     â”‚                                                                          â”‚   â”‚
â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚     â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚      â”‚   â”‚
â”‚     â”‚  â”‚Classifying  â”‚ â”‚Prescribing  â”‚ â”‚Insurance    â”‚ â”‚Vendors      â”‚      â”‚   â”‚
â”‚     â”‚  â”‚Node         â”‚ â”‚Node         â”‚ â”‚Node         â”‚ â”‚Node         â”‚      â”‚   â”‚
â”‚     â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚      â”‚   â”‚
â”‚     â”‚  â”‚â€¢ CNN Model  â”‚ â”‚â€¢ RAG Query  â”‚ â”‚â€¢ MCP Call   â”‚ â”‚â€¢ Supplier   â”‚      â”‚   â”‚
â”‚     â”‚  â”‚â€¢ Attention  â”‚ â”‚â€¢ Treatment  â”‚ â”‚â€¢ Premium    â”‚ â”‚â€¢ Search     â”‚      â”‚   â”‚
â”‚     â”‚  â”‚â€¢ Disease ID â”‚ â”‚â€¢ Dosage     â”‚ â”‚â€¢ Companies  â”‚ â”‚â€¢ Pricing    â”‚      â”‚   â”‚
â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           External Services Layer                                   â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ Prescription    â”‚  â”‚ Sasya Arogya    â”‚  â”‚ Ollama LLM      â”‚  â”‚ MLflow       â”‚  â”‚
â”‚  â”‚ RAG Server      â”‚  â”‚ MCP Server      â”‚  â”‚ Server          â”‚  â”‚ Tracking     â”‚  â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ â€¢ Treatment DB  â”‚  â”‚ â€¢ Insurance API â”‚  â”‚ â€¢ Intent LLM    â”‚  â”‚ â€¢ Experimentsâ”‚  â”‚
â”‚  â”‚ â€¢ Vector Search â”‚  â”‚ â€¢ Premium Calc  â”‚  â”‚ â€¢ Response Gen  â”‚  â”‚ â€¢ Metrics    â”‚  â”‚
â”‚  â”‚ â€¢ RAG Pipeline  â”‚  â”‚ â€¢ PDF Gen       â”‚  â”‚ â€¢ Classificationâ”‚  â”‚ â€¢ Models     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. State Management Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Session State Management                               â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        WorkflowState                                        â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚  Core Fields:                    Service-Specific Fields:                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ session_id                   â”œâ”€ classification_results                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ user_message                 â”œâ”€ disease_name                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ assistant_response           â”œâ”€ prescription_data                     â”‚   â”‚
â”‚  â”‚  â”œâ”€ current_node                 â”œâ”€ insurance_premium_details             â”‚   â”‚
â”‚  â”‚  â”œâ”€ previous_node                â”œâ”€ insurance_recommendations             â”‚   â”‚
â”‚  â”‚  â”œâ”€ next_action                  â”œâ”€ vendor_options                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ messages[]                   â”œâ”€ farmer_name                           â”‚   â”‚
â”‚  â”‚  â”œâ”€ requires_user_input          â”œâ”€ area_hectare                          â”‚   â”‚
â”‚  â”‚  â””â”€ is_complete                  â””â”€ plant_type                            â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚                                          â”‚
â”‚                                          â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     Session Persistence                                     â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚               â”‚  â”‚               â”‚  â”‚               â”‚  â”‚              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ In-Memory     â”‚  â”‚ Database      â”‚  â”‚ Redis Cache   â”‚  â”‚ File System  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Store         â”‚  â”‚ Persistence   â”‚  â”‚ (Optional)    â”‚  â”‚ (Dev/Test)   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚               â”‚  â”‚               â”‚  â”‚               â”‚  â”‚              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Fast Access â”‚  â”‚ â€¢ Long-term   â”‚  â”‚ â€¢ Distributed â”‚  â”‚ â€¢ Simple     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Session Dataâ”‚  â”‚ â€¢ Analytics   â”‚  â”‚ â€¢ Scalable    â”‚  â”‚ â€¢ Debug      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Insurance Service Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Insurance Service Flow                                    â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚                â”‚
â”‚  â”‚ User Request    â”‚â”€â”€â”€â–ºâ”‚ Insurance Node  â”‚â”€â”€â”€â–ºâ”‚ Context         â”‚                â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚ Extraction      â”‚                â”‚
â”‚  â”‚ "I need crop    â”‚    â”‚ â€¢ Analyze input â”‚    â”‚                 â”‚                â”‚
â”‚  â”‚  insurance for  â”‚    â”‚ â€¢ Extract contextâ”‚    â”‚ â€¢ Crop type     â”‚                â”‚
â”‚  â”‚  my wheat farm" â”‚    â”‚ â€¢ Validate data â”‚    â”‚ â€¢ Farm area     â”‚                â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚ â€¢ Location      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                  â”‚                        â”‚                        â”‚
â”‚                                  â–¼                        â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          Missing Info Handler                              â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚   â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ Check Required  â”‚â”€â”€â”€â”€â–ºâ”‚ Extract from    â”‚â”€â”€â”€â”€â–ºâ”‚ Smart Defaults  â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ Fields          â”‚     â”‚ User Message    â”‚     â”‚                 â”‚      â”‚   â”‚
â”‚  â”‚   â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ â€¢ State         â”‚     â”‚ â€¢ Crop patterns â”‚     â”‚ â€¢ Farmer name   â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ â€¢ Area          â”‚     â”‚ â€¢ Area patterns â”‚     â”‚ â€¢ Default area  â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ â€¢ Crop type     â”‚     â”‚ â€¢ State patternsâ”‚     â”‚ â€¢ Fallback crop â”‚      â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â”‚                                                  â”‚
â”‚                                  â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         Insurance Tool                                      â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚   â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ Premium         â”‚     â”‚ Company         â”‚     â”‚ Recommendations â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ Calculation     â”‚     â”‚ Comparison      â”‚     â”‚                 â”‚      â”‚   â”‚
â”‚  â”‚   â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ â€¢ Base premium  â”‚     â”‚ â€¢ Rate analysis â”‚     â”‚ â€¢ Policy match  â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ â€¢ Risk factors  â”‚     â”‚ â€¢ Coverage opts â”‚     â”‚ â€¢ Best options  â”‚      â”‚   â”‚
â”‚  â”‚   â”‚ â€¢ Subsidies     â”‚     â”‚ â€¢ Terms compare â”‚     â”‚ â€¢ Custom advice â”‚      â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â”‚                                                  â”‚
â”‚                                  â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        MCP Server Interface                                 â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚         â”‚   â”‚
â”‚  â”‚  â”‚ HTTP Client     â”‚â”€â”€â”€â–ºâ”‚ MCP Server      â”‚â”€â”€â”€â–ºâ”‚ Response        â”‚         â”‚   â”‚
â”‚  â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚ Processing      â”‚         â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ POST requests â”‚    â”‚ â€¢ Premium calc  â”‚    â”‚                 â”‚         â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Error handlingâ”‚    â”‚ â€¢ Company data  â”‚    â”‚ â€¢ Format resultsâ”‚         â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Timeout mgmt  â”‚    â”‚ â€¢ PDF generationâ”‚    â”‚ â€¢ Extract data  â”‚         â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Intent Analysis System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Agriculture Intent Analyzer                                  â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              Input Layer                                    â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚    User Message: "I want to buy crop insurance for my 5 hectare farm"      â”‚   â”‚
â”‚  â”‚                                    â”‚                                        â”‚   â”‚
â”‚  â”‚                                    â–¼                                        â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ Text            â”‚    â”‚ Context         â”‚    â”‚ Session         â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ Preprocessing   â”‚    â”‚ Extraction      â”‚    â”‚ History         â”‚       â”‚   â”‚
â”‚  â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ Lowercase     â”‚    â”‚ â€¢ Plant type    â”‚    â”‚ â€¢ Previous      â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ Tokenization  â”‚    â”‚ â€¢ Location      â”‚    â”‚   intents       â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ Normalization â”‚    â”‚ â€¢ Disease info  â”‚    â”‚ â€¢ Context       â”‚       â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                              â”‚
â”‚                                      â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           Rule Engine                                       â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ Insurance Rules â”‚    â”‚ Vendor Rules    â”‚    â”‚ Treatment Rules â”‚       â”‚   â”‚
â”‚  â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ Keywords:       â”‚    â”‚ Keywords:       â”‚    â”‚ Keywords:       â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ insurance     â”‚    â”‚ â€¢ buy           â”‚    â”‚ â€¢ treatment     â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ premium       â”‚    â”‚ â€¢ purchase      â”‚    â”‚ â€¢ prescription  â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ coverage      â”‚    â”‚ â€¢ vendor        â”‚    â”‚ â€¢ dosage        â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ policy        â”‚    â”‚ â€¢ shop          â”‚    â”‚ â€¢ medicine      â”‚       â”‚   â”‚
â”‚  â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ Exclusions:     â”‚    â”‚ Exclusions:     â”‚    â”‚ Context Req:    â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ pesticide     â”‚    â”‚ â€¢ insurance     â”‚    â”‚ â€¢ disease       â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ â€¢ fertilizer    â”‚    â”‚ â€¢ policy        â”‚    â”‚ â€¢ plant type    â”‚       â”‚   â”‚
â”‚  â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚       â”‚   â”‚
â”‚  â”‚    â”‚ Priority: 10    â”‚    â”‚ Priority: 7     â”‚    â”‚ Priority: 9     â”‚       â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                              â”‚
â”‚                                      â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Confidence Scoring                                   â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚    Intent: "insurance"                                                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ Keyword matches: insurance(+0.3), crop(+0.3), buy(+0.3)              â”‚   â”‚
â”‚  â”‚    â”œâ”€ Exclusions: None found (+0.0)                                        â”‚   â”‚
â”‚  â”‚    â”œâ”€ Context boost: farm mentioned (+0.2)                                 â”‚   â”‚
â”‚  â”‚    â”œâ”€ Priority multiplier: 10 (highest)                                    â”‚   â”‚
â”‚  â”‚    â””â”€ Final confidence: 0.8                                                â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚    Intent: "vendor"                                                         â”‚   â”‚
â”‚  â”‚    â”œâ”€ Keyword matches: buy(+0.3)                                           â”‚   â”‚
â”‚  â”‚    â”œâ”€ Exclusions: insurance(-0.2)                                          â”‚   â”‚
â”‚  â”‚    â”œâ”€ Context requirement: No agricultural product (-0.3)                  â”‚   â”‚
â”‚  â”‚    â””â”€ Final confidence: 0.1                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                              â”‚
â”‚                                      â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           Output                                            â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚    Primary Intent: "insurance" (confidence: 0.8)                           â”‚   â”‚
â”‚  â”‚    â””â”€ Route to: InsuranceNode                                               â”‚   â”‚
â”‚  â”‚                                                                             â”‚   â”‚
â”‚  â”‚    All Intents:                                                             â”‚   â”‚
â”‚  â”‚    â”œâ”€ insurance: 0.8                                                        â”‚   â”‚
â”‚  â”‚    â”œâ”€ treatment: 0.2                                                        â”‚   â”‚
â”‚  â”‚    â”œâ”€ vendor: 0.1                                                           â”‚   â”‚
â”‚  â”‚    â””â”€ classification: 0.0                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Patterns

### 1. New Session Initialization
```
User Request â†’ Initial Node â†’ Intent Analysis â†’ Route to Service Node â†’ Update State â†’ Response
```

### 2. Follow-up Conversations  
```
User Request â†’ Followup Node â†’ Loop Prevention Check â†’ Intent Analysis â†’ Route/Complete â†’ Response
```

### 3. Multi-Service Workflow
```
Disease Image â†’ Classification â†’ Treatment â†’ Insurance â†’ Vendors â†’ Completion
     â–²              â”‚             â”‚           â”‚           â”‚           â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            State Accumulation
```

### 4. Error Recovery Flow
```
Service Failure â†’ Error Node â†’ Log/Track â†’ Fallback Response â†’ Continue/Restart
```

## Performance Characteristics

### Response Time Targets
- **Intent Analysis**: < 100ms
- **Disease Classification**: < 2s
- **Insurance Premium Calc**: < 3s  
- **Treatment Recommendations**: < 1s
- **Complete Workflow**: < 10s

### Scalability Metrics
- **Concurrent Sessions**: 1000+
- **Requests/Second**: 100+
- **Session Storage**: 10GB+
- **ML Model Memory**: 2GB per instance

### Reliability Features
- **Circuit Breakers**: Prevent cascade failures
- **Retry Logic**: Automatic retry with backoff
- **Graceful Degradation**: Fallback responses when services are down
- **Health Checks**: Continuous monitoring of all components

This architecture provides a solid foundation for agricultural intelligence services while maintaining flexibility for future enhancements and integrations.
