graph TB
    subgraph "API Gateway Layer"
        A[ðŸŒ FastAPI Server :8080]
        B[â¤ï¸ Health Endpoints]
        C[ðŸ“Š Metrics Endpoints]
        D[ðŸ’¾ Session Management]
    end
    
    subgraph "Core Services"
        E[ðŸ”„ FSM Agent Service]
        F[ðŸ§  Intent Analysis Service]
        G[ðŸ” Classification Service]
        H[ðŸ’Š Prescription Service]
    end
    
    subgraph "External Services"
        I[ðŸ›¡ï¸ Insurance MCP Service]
        J[ðŸª Vendor Service]
        K[ðŸ—ƒï¸ ChromaDB Service]
        L[ðŸ¤– Ollama LLM Service]
    end
    
    subgraph "Data Layer"
        M[ðŸ’¾ Session Store]
        N[ðŸ§  Model Storage]
        O[ðŸ” Vector Database]
        P[âš™ï¸ Configuration Store]
    end
    
    subgraph "Observability Services"
        Q[ðŸ“Š OpenTelemetry Collector]
        R[ðŸ“ˆ Prometheus Server]
        S[ðŸ“Š Grafana Dashboard]
        T[ðŸ” Jaeger Tracing]
    end
    
    A --> E
    A --> F
    A --> G
    A --> H
    
    E --> I
    E --> J
    F --> L
    G --> L
    H --> K
    
    E --> M
    G --> N
    H --> O
    A --> P
    
    A --> Q
    E --> Q
    F --> Q
    G --> Q
    H --> Q
    
    Q --> R
    Q --> T
    R --> S
    
    classDef apiLayer fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef coreLayer fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef externalLayer fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef dataLayer fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef observabilityLayer fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    
    class A,B,C,D apiLayer
    class E,F,G,H coreLayer
    class I,J,K,L externalLayer
    class M,N,O,P dataLayer
    class Q,R,S,T observabilityLayer